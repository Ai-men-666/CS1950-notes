没怎么听懂（-_-||），仅供参考



本示例密码本：初始转子设置$LMN$

转子移位置换

$P_m=(abcdefghijklmnopqrstuvwxyz)$



Enigma加密过程：

理论上一个信号会由数个转子产出的移位信号与其逆元包裹，如

输入明文$@$

顺次经过$LMN$转子加密与$HS$接线
形成密文$@^*=SHNML@L^{-1}M^{-1}N^{-1}H^{-1}S^{-1}$

（这个形式保证了$((\cdot)^*)^{-1}=(\cdot)^*$，表示它可以拆成对换之积）

事实上，转子在运行一次后会执行一次移位操作，加密法则会有所改变。

如假设在上述$N$转子加密的一步附加转子移位操作$P_m$，则可以将运行1，2，3，...，6步后的法则$A,B,C,D,E,F$表示为

$A=(P_mNP_m^{-1})(ML@L^{-1}M^{-1})(P_mN^{-1}P_m^{-1})$ 

$B=(P_m^2NP_m^{-2})(ML@L^{-1}M^{-1})(P_m^2N^{-1}P_m^{-2})$

$C=(P_m^3NP_m^{-3})(ML@L^{-1}M^{-1})(P_m^3N^{-1}P_m^{-3})$

等等。$A$ 的三个转子设置即为$L,M,P_mNP_m^{-1}$。

同样$A$具有逆元为本身与可拆成对换的性质。其他五个同理。



真实历史上，根据德军采用的特殊规则（由每个发信方各自确定当日的specific key，并在当天正式发报前根据公用的daily key规则将specific key连续发送两次给收信方，有意义的破解目标仅仅是daily key $LMN$，或者说$ABCDEF$六个加密规则），协约国一方据此制作了针对性的解码机器。

如$svgsmf$作为specific key（明文$@_1@_2@_3$）重复两遍后的六字符密文，满足

$A(@_1)=s,B(@_2)=v,C(@_3)=g,D(@_1)=s,E(@_2)=m,F(@_3)=f$

这样有

$AD(s)=A(D(s))=A(D^{-1}(s))=s$ 等等。

根据大量截获的初始六字符密文得到下面的三组加密法则轮换组合：

$AD=(dvpfkxgzyo)(eijmunqlht)(bc)(rw)(a)(s)$

$BE=(bljqveoum)(hjpswizrn)(axt)(cgy)(d)(k)$

$CF=(abviktjgfcqny)(duzrehlxwpsmv)$



在以上条件下，考虑密文$svgsmf$，它的第一个明文字符一定为$a$，后两个不可能为$a$。

解释：

考虑将$A,D$加密法则展开为对换（$2n=26$）

$A=(a_1a_2)(a_3a_4)...(a_{2n-1}a_{2n})$

$D=(a_2a_3)(a_4a_5)...(a_{2n}a_1)$

其中，每一个置换中的两个元素互为明/密文。

则无重复最好状态下， $AD=(a_1a_3a_5...a_{2n-1})(a_{2n}a_{2n-2}a_{2n-4}...a_2)$

但由于这些$a_i$随机生成，有很大的可能其中产生重复

这导致$AD$不再是两个完整的n-轮换，而是会裂解出为一些较小的轮换。

如：$A$中存在一个$(a,s)$，$D$中存在一个$(s,a)$，

$AD$中就会存在两个孤立轮换$(a)(s)=(a,s)(s,a)$

更一般地，关于$AD$的形式我们有结论：

$AD$应当由两个$n_1$-轮换$P_1,P_1^*$,两个$n_2$-轮换$P_2,P_2^*$,...,两个$n_k$-轮换$P_k,P_k^*$组成，

$n_1+n_2+...+n_k=n$

且对相互等位（有时候等长轮换不止一对，但等位关系必定存在）的两个轮换$P_i,P_i^*$,有性质：$P_i,(P_i^*)^{-1}$在字符集上关于置换操作存在一个同构恰好为$A$中加密/解密对应，如

$AD$含有$(dvpfkxgzyo)(eijmunqlht)$ 轮换，且假设已知$(f,m)$互为$A$中明文/密文，

则可以破译出$(p,u),(k,j),(v,n),(x,i),...$也是互为$A$中明文/秘文。

在上面的例子中，可以由$AD$恰有两个孤立元$(a),(s)$立即推出$(a,s)$互为$A$中明文/密文。

所以在$svgsmf$例子中，明文的1,4位必定是$a$，2,3,5,6位必定不是$a$。

此性质可以加速破译进程。
